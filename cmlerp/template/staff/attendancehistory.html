<HTML><HEAD><TITLE></TITLE>
<META http-equiv=Content-Type content="text/html; charset=utf-8">
<META HTTP-EQUIV="empiresoft" CONTENT="no-cache">
<link href="[#path#]css/button_css.css" rel="stylesheet" type="text/css">
<link href="[#path#]css/page_title.css" rel="stylesheet" type="text/css">
<LINK href="[#path#]css/browse.css" type=text/css rel=stylesheet>
<LINK href="[#path#]css/css.css" rel=stylesheet type=text/css>
<SCRIPT language=javascript src="[#path#]js/dateobject.js"></SCRIPT>
<SCRIPT language=javascript src="[#path#]js/datepicker.js"></SCRIPT>
<SCRIPT language=javascript src="[#path#]js/editlib.js"></SCRIPT>
<style type="text/css">
<!--
.STYLE3 {font-size: 12px}
-->
</style>
</HEAD>
<script language=javascript>
<!-- 
var requestSubmitted = false;

function tourl(url)
{
	window.location.href=url;
}
function CheckAll(form){
     for (var i=0;i<form.elements.length;i++){ 
         var strelement = form.elements[i];
         if (strelement.name != 'chkall' && !strelement.disabled){
             strelement.checked = form.chkall.checked;
         }
      }
}

function submit_save(){
	var idarray = new Array();//定义一个数组
	var cv = document.getElementsByName("TheID[]");
	var m = 0;
	for(var i=0; i<cv.length; i++)
	{
		if(cv[i].type.toLowerCase() == "checkbox")
		{
			if(cv[i].checked)
			{
				idarray[m] = cv[i].value;
				m++;
			}
		}
	}
	var id = idarray.join(",");
	if(!id || id == "0")
	{
		alert("没有勾选要操作的主题！");
		return false;
	} 
	form1.id.value = id;
	     

	if(requestSubmitted == true){
    alert("你已经提交，请等待一下");
    return (false);
   } 
   
   
  requestSubmitted = true; 	
		
    form1.action.value = "upd";
	
	form1.submit();
	  
}

function savetohistory(){
		if(form1.batch.value == ""){
           alert("请输入批次名称");
		   return;
		}
		tourl('?action=savetohistory&batch='+form1.batch.value)  

 
}




function countwage(staid,o){   
      var othours="othours"+staid;
	  var timeoff="timeoff"+staid;
	  var memo="memo"+staid;
	  var leavehours="leavehours"+staid;
	  var lastremainot="lastremainot"+staid;
	  var addupot="addupot"+staid;
	  var memo="memo"+staid;
	  	  
	  if (parseFloat(document.getElementById(othours).value)+parseFloat(document.getElementById(lastremainot).value)<parseFloat(document.getElementById(timeoff).value))
	  {
	  document.getElementById(memo).innerHTML="<a href=# onclick=javascript:toleave("+staid+") title=加班时间不足以补钟，点将不足部分击转为请假时间><font color=red>没有时间补钟，点击操作</font></a>";
	  o.focus();
	  }else{
	  document.getElementById(memo).innerHTML='';
	  }

	  document.getElementById(addupot).value=parseFloat(document.getElementById(lastremainot).value)+parseFloat(document.getElementById(othours).value)-parseFloat(document.getElementById(timeoff).value);
	 
}
function toleave(staid){
		question = confirm("确认将不足部分转换为请假时间吗！");
		if (question != "0")
		{

      var othours="othours"+staid;
	  var timeoff="timeoff"+staid;
	  var leavehours="leavehours"+staid; 
	  var addupot="addupot"+staid;
	  var memo="memo"+staid;
	  document.getElementById(leavehours).value=parseFloat(document.getElementById(leavehours).value)-parseFloat(document.getElementById(addupot).value);
	  document.getElementById(timeoff).value=document.getElementById(othours).value
	  document.getElementById(memo).innerHTML='';
	   document.getElementById(addupot).value=0;
}
        else{
		return;
		}
}

function help(){  
   if(document.getElementById("helpid").style.pixelHeight == 0 &&  document.getElementById("helpid").style.display == "none"){      
       document.getElementById("helpid").style.display = "";
	  ChS();
   }else{   
	   HhS();    	  
   }
}

function ChS(){
if(helpid.style.pixelHeight<450){helpid.style.pixelHeight+=10;setTimeout("ChS()",0.5);
} 
}
function HhS(){
if(helpid.style.pixelHeight > 0){helpid.style.pixelHeight-=10;setTimeout("HhS()",0.5);
}
if(helpid.style.pixelHeight == 0){
 document.getElementById("helpid").style.display = "none";
 }
}

function CheckAll(form){
     for (var i=0;i<form.elements.length;i++){ 
         var strelement = form.elements[i];
         if (strelement.name != 'chkall' && !strelement.disabled){
             strelement.checked = form.chkall.checked;
         }
      }
   }

	function CheckAll(checkBoxName){
			var checkBox = document.getElementsByName(checkBoxName);
			for (var i = 0; i < checkBox.length; i++){
				var temp = checkBox[i];
				temp.checked = true;
			}
	}
	function CheckReverse(checkBoxName){
		var checkBox = document.getElementsByName(checkBoxName);
		for (var i = 0; i < checkBox.length; i++){
			var temp = checkBox[i];
			temp.checked = !temp.checked;
		}
	}

// -->
</script>

<BODY  onload=input_focus() topmargin="0" leftMargin="2" width="100%">
  <table width="100%" border="0" cellspacing="0" cellpadding="0" height="30">
                         <td height="30" class="pagetitle"  width="100%" valign="middle">
          &nbsp;&nbsp;<img src="[#path#]img/nowspace.jpg" align="absmiddle"> 出勤情况</td>
			<tr>
           <td align="left"><div style="margin:0px 0px 0px 12px;"><img src="[#path#]img/line.jpg" ></div></td>
          </tr>	
  </table>
  <center>
    <FORM name=form1 action="" method=post>
      <INPUT type=hidden name=action>
      <INPUT 
type=hidden  name=id>
      <TABLE height=31 cellSpacing=0 cellPadding=0 width="98%" border=0>
        <TBODY>
          <TR>
            <TD class=button_labelleft></TD>
            <TD class=button_label><DIV style="MARGIN: 0px" align=left>
              <INPUT class=button_new onMouseOver="this.style.backgroundImage='url([#path#]img//new_sel.jpg)'" style="FONT-SIZE: 9pt" accessKey=h onclick=javascript:help() onMouseOut="this.style.backgroundImage='url([#path#]img/new.jpg)'" type=button value="     帮助" name=save32>
              <input style="display:[#canadd#]"  class=button_new onMouseOver="this.style.backgroundImage='url([#path#]img/new_sel.jpg)'" accesskey=n onClick="location.href='?action=add'"  onMouseOut="this.style.backgroundImage='url([#path#]img/new.jpg)'" type=button value="  新增" name=thenew>
              <input class=button_save onMouseOver="this.style.backgroundImage='url([#path#]img/save_sel.jpg)'" style="FONT-SIZE: 9pt" accesskey=s onClick=javascript:submit_save() onMouseOut="this.style.backgroundImage='url([#path#]img/save.jpg)'" type=button value="     暂存" name=save3>
              <INPUT class=button_reset onMouseOver="this.style.backgroundImage='url([#path#]img/reset_sel.jpg)'" style="FONT-SIZE: 9pt" accessKey=z onMouseOut="this.style.backgroundImage='url([#path#]img/reset.jpg)'" type=reset value="     撤销" name=qqq>
                <input  style="display:[#canimport#]" class=button_infile onMouseOver="this.style.backgroundImage='url([#path#]img/infile_sel.jpg)'" accesskey=i onClick="javascript:tourl('attendanceimport.php?agencyid=[#agencyid#]&pre=[#pre#]')" onMouseOut="this.style.backgroundImage='url([#path#]img/infile.jpg)'" type=button value="  导入考勤" name=theinputfile>
            </DIV></TD>
            <TD class=button_labelright></TD>
          </TR>
        </TBODY>
      </TABLE>
      <BR>
      <TABLE class=InputFrameMain cellSpacing=0 cellPadding=0 width=758 border=0>
        <TBODY>
          <TR>
            <TD align=left colSpan=4><TABLE cellSpacing=0 cellPadding=0 border=0>
                <TBODY>
                  <TR>
                    <TD class=inputtitle align=middle width=150>资料输入</TD>
                    <TD class=inputtitleright 
            align=middle>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
                    <TD align=middle><FONT 
      color=#ff0000><B></B></FONT></TD>
                  </TR>
                </TBODY>
            </TABLE></TD>
          </TR>
          <TR>
            <TD class=form_label align=right width=120 height=10></TD>
            <TD align=left width=215></TD>
            <TD class=form_label width=93></TD>
            <TD align=left width=272></TD>
          </TR>
          <TR>
            <TD class=form_label align=right height=30>批次名称：</TD>
            <TD align=left colSpan=3 height=30><INPUT class=input_right 
      style="IME-MODE: disabled" onfocus=this.select() value=[#batch#] name='batch'>
              *
              <INPUT class=buttonsmall style="FONT-SIZE: 9pt; display:none" onclick=javascript:savetohistory() type=button value=归档到历史 name=save> 
              查看历史记录：
              <SELECT name=select   onChange="tourl('?action=viewhistorty&batch='+this.value)">
                <OPTION value='[#batch#]'  selected>-选择月份-</OPTION>
                   [#historylist#]    
              </SELECT>
              <INPUT class=buttonsmall  style="FONT-SIZE: 9pt" onclick=javascript:tourl('?') type=button value=返回本月 name=save2></TD>
          </TR>
          </TR>
        </TBODY>
      </TABLE>
      <BR>
      <TABLE cellSpacing=0 width="100%" border=0>
        <TBODY>
          <TR>
            <TD borderColor=#ffffff align=right width="3%" bgColor=#ffffff><span class="listcelltitle">
               <input name="checkbox" type="checkbox" onClick="
	 javascript:if(this.checked)
	 {
	 CheckAll('TheID[]')
	 }
	 else
	 {CheckReverse('TheID[]')
	 }" />
            </span></TD>
            <TD borderColor=#ffffff align=left width="7%" bgColor=#ffffff><SPAN 
      class=STYLE3>全选/反选</SPAN></TD>
            <TD borderColor=#ffffff align=left width="90%" bgColor=#ffffff>&nbsp;</TD>
          </TR>
        </TBODY>
      </TABLE>
      <TABLE class=tableframe style="WORD-BREAK: break-all" width="98%" 
  align=center>
        <TBODY>
          <TR class=listtitle>
            <TD class=listcelltitle noWrap align=middle height=25>员工编号</TD>
            <TD class=listcelltitle noWrap align=middle height=25>员工姓名</TD>
            <TD class=listcelltitle noWrap align=middle height=25>职级</TD>
            <TD class=listcelltitle noWrap align=middle height=25>计划出勤</TD>
            <TD class=listcelltitle noWrap align=middle height=25>实际出勤</TD>
            <TD class=listcelltitle noWrap align=middle height=25>请假(h)</TD>
            <TD class=listcelltitle noWrap align=middle height=25>补休</TD>
            <TD class=listcelltitle noWrap align=middle height=25>本月加班(h)</TD>
			<TD class=listcelltitle noWrap align=middle height=25>上月剩余</TD>
			<TD class=listcelltitle noWrap align=middle height=25>累计加班</TD>
            <TD class=listcelltitle noWrap align=middle height=25>结算加班费</TD>
			<TD class=listcelltitle noWrap align=middle height=25 width="10%">备注</TD>
          </TR>
		    <!-- BEGIN mainlist -->
          <TR class=listrow1 onMouseOver="this.style.backgroundColor='#DAE2ED';" 
  onmouseout="this.style.backgroundColor='#FFFFFF'" bgColor=#ffffff>
            <TD class=listcelltitle noWrap align=left height=25><INPUT   name="TheID[]" type="checkbox"
      value=[#attendance_id#] >
              [#employee_no#]</TD>
            <TD class=listcelltitle noWrap align=middle height=25>&nbsp;[#employee_name#]</TD>
            <TD class=listcelltitle noWrap align=middle height=25>&nbsp;[#employeelevel_name#]</TD>
            <TD class=listcelltitle noWrap align=middle height=25>&nbsp;
            <input 
      class=input_right id=planattendance[#attendance_id#] onKeyUp="countwage('[#attendance_id#]',this)" 
      style="IME-MODE: disabled" onFocus=this.select() size=3 value='[#planattendance#]'
      name=planattendance[#attendance_id#]></TD>
            <TD class=listcelltitle noWrap align=middle height=25>&nbsp;
                <INPUT 
      class=input_right id=actualattendance[#attendance_id#] onKeyUp="countwage('[#attendance_id#]',this)" 
      style="IME-MODE: disabled" onfocus=this.select() size=3 value='[#actualattendance#]' 
      name=actualattendance[#attendance_id#]></TD>
            <TD class=listcelltitle noWrap align=middle height=25><INPUT 
      class=input_right id=leavehours[#attendance_id#] onKeyUp="countwage('[#attendance_id#]',this)" 
      style="IME-MODE: disabled" onfocus=this.select() size=3 value='[#leavehours#]'
      name=leavehours[#attendance_id#]></TD>
            <TD class=listcelltitle noWrap align=middle height=25>&nbsp;
                <input 
      class=input_right id=timeoff[#attendance_id#] onKeyUp="countwage('[#attendance_id#]',this)"  onChange="addupot('[#attendance_id#]',this)"
      style="IME-MODE: disabled" onFocus=this.select() size=3 value='[#timeoff#]'
      name=timeoff[#attendance_id#]>
                &nbsp; </TD>
            <TD class=listcelltitle noWrap align=middle height=25>&nbsp;&nbsp;<INPUT 
      class=input_right id=othours[#attendance_id#] onKeyUp="countwage('[#attendance_id#]',this)" 
      style="IME-MODE: disabled" onfocus=this.select() size=3 value='[#othours#]' 
      name=othours[#attendance_id#]>
            </TD>

            <INPUT id=xj1 type=hidden value=0 name=xj1>
            <TD class=listcelltitle noWrap align=middle height=25><INPUT 
      class=input_right id=lastremainot[#attendance_id#] onKeyUp="countwage('[#attendance_id#]',this)" 
      style="IME-MODE: disabled" onfocus=this.select() size=3 value='[#lastremainot#]' 
      name=lastremainot[#attendance_id#]></TD>
			<TD class=listcelltitle noWrap align=middle height=25><INPUT 
      class=input_right id=addupot[#attendance_id#] onKeyUp="countwage('[#attendance_id#]',this)" 
      style="IME-MODE: disabled" onfocus=this.select() size=3 value='[#addupot#]' 
      name=addupot[#attendance_id#]></TD>
			<TD class=listcelltitle noWrap align=middle height=25>[#clearot#]</TD>
            <TD class=listcelltitle noWrap align=middle height=25>&nbsp;<span id=memo[#attendance_id#]>&nbsp;</span><SCRIPT language=javascript >countwage('[#attendance_id#]',this)</SCRIPT></TD>
          </TR>
 <!-- END mainlist --> 
          </TR>
        </TBODY>
      </TABLE>
      <BR>
    </FORM>
    <div id="sending" STYLE="LEFT: 0px; WIDTH: 95%; POSITION: absolute; TOP: 50%; HEIGHT: 95%; display:none"> 
       <table width=400 height=80 border=0 cellspacing=2 cellpadding=0 >
          <tr> 
               <td bgcolor=#F1F4F9 align=center>ڱݣԺ...</td>
          </tr>
       </table>
</div>
<div id="sendingdel" STYLE="LEFT: 0px; WIDTH: 95%; POSITION: absolute; TOP: 50%; HEIGHT: 95%; display:none"> 
       <table width=400 height=80 border=0 cellspacing=2 cellpadding=0 >
          <tr> 
               <td bgcolor=#F1F4F9 align=center>ɾݣԺ...</td>
          </tr>
       </table>
</div>
<div id="sendingbg" STYLE="LEFT: 0px; WIDTH: 100%; POSITION: absolute; TOP: 0px; HEIGHT: 100%; display:none"> 
</div>
<div id="helpid" STYLE="left: 1%; WIDTH: 450px; POSITION: absolute; TOP: 86px; HEIGHT: 0; display:none;"> 
 <div  align="left"   STYLE="position:absolute;left: 15px; top:15px;right:15px" >
 
 ĳʵнʽηţϵͳԶʹʺ͸ۼӵԱʻͬʱõĸ˰˰ΧԶ˰<br>
ͿɹʷŵĹˡ<br>
ע⣺ʷǷεʹʲְԱʣһοԷʹͬһʵԱʣһνзţεĸҲԶۼӵԱʻˣڡ롰ʾˡ
      һֻҪӦһʣһζӦʡ<br>



 
 <br><br>
  нʹ��нʷţ<br><br>
  (Alt+s)㹤ʣ<br><br>
  (Alt+z)нϢӵ<br><br>
  (Alt+q)عϢб��<br><br>
  (Alt+h)ʾϢ
</div>
</div>
</center>
</body>
</html>

