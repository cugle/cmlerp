<HTML>
<HEAD>
<TITLE>月结存</TITLE>
<META http-equiv=Content-Type content="text/html; charset=UTF-8">
<META HTTP-EQUIV="dianduo" CONTENT="no-cache">
<META HTTP-EQUIV="empiresoft" CONTENT="no-cache">
<link href="[#path#]css/button_css.css" rel="stylesheet" type="text/css">
<link href="[#path#]css/page_title.css" rel="stylesheet" type="text/css">
<LINK href="[#path#]css/browse.css" type=text/css rel=stylesheet>
<LINK href="[#path#]css/css.css" rel="stylesheet" type="text/css">

<style type="text/css">
<!--
.flat_input {	BORDER-RIGHT: #546485 1px solid; BORDER-TOP: #546485 1px solid; BORDER-LEFT: #546485 1px solid; BORDER-BOTTOM: #546485 1px solid
}
-->
</style>
</HEAD>
<SCRIPT language=javascript src="[#path#]js/editlib.js"></SCRIPT>
<script type="text/javascript" src="../common/js/jquery-1.2.1.pack.js"></script>

<LINK media=screen 
href="[#path#]css/flexselect.css" type=text/css 
rel=stylesheet>
<SCRIPT language="javascript" src="[#path#]js/browse.js" type="text/javascript"></SCRIPT>
<SCRIPT language=javascript src="[#path#]js/calendar.js" type=text/javascript></SCRIPT>
<SCRIPT src="[#path#]js/jquery.min.js" 
type=text/javascript></SCRIPT>

<SCRIPT src="[#path#]js/liquidmetal.js" 
type=text/javascript></SCRIPT>

<SCRIPT src="[#path#]js/jquery.flexselect.js" 
type=text/javascript></SCRIPT>

    <script type="text/javascript">
	<!-- 
      $(document).ready(function() {
        $("select[class*=flexselect]").flexselect();
       // $("input:text:enabled:first").focus();
        $("form").submit(function() {
          alert($(this).serialize());
          return false;
        });
      });
	  
function jsSelectItemByValue(objSelect, objItemText) {           
    //判断是否存在       
    var isExit = false;       
    for (var i = 0; i < objSelect.options.length; i++) {       
        if (objSelect.options[i].text == objItemText) {       
            objSelect.options[i].selected = true;       
            isExit = true;       
            break;       
        }       
    }             
    //Show出结果       
    if (isExit) {       
        alert("成功选中");       
    } else {       
        alert("该select中 不存在该项");       
    }       
}  	  
 function copyobject(bgobject,endobject){
	
	  document.getElementById(endobject).value=document.getElementById(bgobject).value;
	
 }
 function copyaccounttitle(bgobject,endobject){
	
	document.getElementById('endaccounttitle_no').value=document.getElementById('bgaccounttitle_no').value;
	document.getElementById('endaccounttitle_no_flexselect').value=document.getElementById('bgaccounttitle_no_flexselect').value;

 }
function selectobject(i){
	
   var arrItems=new Array();
   var strItem ;
   objecttype_id=document.getElementById('objecttype_id').value;
	
   var szRef = "../getdata/getobject.php?template=getobject&&id="+objecttype_id;
   var strItem = window.showModalDialog(szRef,"","Help=no;status:no;dialogWidth=700px;dialogHeight=500px;scroll=yes;");
   arrItems = strItem.split("@@@");
   
   document.getElementById(i+'object_id').value= arrItems[0];     
   document.getElementById(i+'object_no').value =arrItems[2];
	
}
function InitAjax()
{
　var ajax=false; 
　try { 
　　ajax = new ActiveXObject("Msxml2.XMLHTTP"); 
　} catch (e) { 
　　try { 
　　　ajax = new ActiveXObject("Microsoft.XMLHTTP"); 
　　} catch (E) { 
　　　ajax = false; 
　　} 
　}
　if (!ajax && typeof XMLHttpRequest!='undefined') { 
　　ajax = new XMLHttpRequest(); 
　} 
　return ajax;
}
function promem(){
   var arrItems=new Array();
   var strItem ;
//   var addbutton = 1;
   var szRef = "../getdata/getaccounttitle.html";
   var strItem = window.showModalDialog(szRef,"","Help=no;status:no;dialogWidth=700px;dialogHeight=500px;scroll=yes;");
   
     arrItems = strItem.split("@@@");
     form1.accounttitle_id.value    = arrItems[0];     
     form1.accounttitle_name.value  = arrItems[1];
	  
}
function submit_save(){
	 if(document.getElementById('bgaccounttitle_no').value==''){
		 alert('请选择科目！');
		 return;
	 }
	 	 if(document.getElementById('bgobject_no').value==''){
		 alert('请选择对象！');
		 return;
			 
	 }
	 	 if(document.getElementById('bgdate').value==''){
		 alert('请选择日期！');
		 return;

	 }
	 
  if (confirm("是否进行统计？")) {
	  
	  if(document.getElementById('endaccounttitle_no').value==''){
	  document.getElementById('endaccounttitle_no').value=document.getElementById('bgaccounttitle_no').value;
	  document.getElementById('endaccounttitle_no_flexselect').value=document.getElementById('bgaccounttitle_no_flexselect').value;	  
	  }
	  if(document.getElementById('enddate').value==''){
	  document.getElementById('enddate').value=document.getElementById('bgdate').value;
	  
	  }
	  if(document.getElementById('endobject_no').value==''){
	  document.getElementById('endobject_no').value=document.getElementById('bgobject_no').value;
	  }
	  
	  
    form1.action.value = "detaillist";
	url='?action=detaillist&bgaccounttitle_no='+form1.bgaccounttitle_no.value+'&endaccounttitle_no='+form1.endaccounttitle_no.value+'&bgdate='+form1.bgdate.value+'&enddate='+form1.enddate.value+'&bgobject_no='+form1.bgobject_no.value+'&endobject_no='+form1.endobject_no.value+'&objecttype_id='+form1.objecttype_id.value;
    sending.style.display ="";
	sendingbg.style.display ="";
	tourl(url);
	 //form1.submit();
	}
}

function tourl(url)
{
	window.location.href=url;
}
// -->
</script>

<BODY>
  <form action="?action=detaillist" method="post" name="form1">
     <input type="hidden" name="action" value="" >
  <table width="100%" border="0" cellspacing="0" cellpadding="0" height="50">
    <tr> 
      <td colspan="2" >&nbsp;&nbsp;<img src="[#path#]img/nowspace.jpg" align="absmiddle">明细账</td>
    </tr>
	<tr>
	 <td height="10" align="left"><div style="margin:0px 0px 0px 12px;"><img src="[#path#]img/line.jpg" ></div></td>
	</tr>
</table>
<center>
<table width="700" class=InputFrameMain cellspacing="0" cellpadding="0" border="0">
      <tbody>
        <tr>
          <td height="13" colspan="2" align="center" class=inputtitle>明细账</td>
          <td colspan="2" align="center" class=inputtitleright><b><font color="#ff0000" class="error">{error}</font></b></td>
        </tr>
        <tr>
          <td colspan="4" height="5" align="left" valign="top">&nbsp;</td>
        </tr>
        <tr>
          <td height="19" colspan="3"  align="right"><span class="form_label"> </span></td>
          <td align="left">    <input type="hidden" name="monthlybatch_name" value="[#monthlybatch_name#]">      </td>
        </tr>      		
		<tr>
		  <td width="34" height="23"  align="right"  class = titlefont>&nbsp;</td>
		  <td width="61" align="left"  class = titlefont>选泽时间</td>
		  <td width="39" height="13" align="right">&nbsp;</td>
		  <td align="left">&nbsp;</td>
	    </tr>
		<tr>
		  <td height="5" colspan="4" valign="top"><img src="[#path#]img/shortline.jpg" ></td>
	    </tr>
		<tr>
		  <td height="28" colspan="3" align="right"  class="form_label">起始科目：</td>
		  <td>
		    <select class="flexselect" id='bgaccounttitle_no'  tabindex="2"  
                  style="FONT-SIZE: 12px" name='bgaccounttitle_no'>
	        <option value="" selected></option>
  
                     [#accounttitlelist#]    

                  
</select>
		    <a  style="CURSOR: hand" onClick="copyaccounttitle('bgaccounttitle_no','endaccounttitle_no');">—&gt;</a>
		    <select class="flexselect" id='endaccounttitle_no'  tabindex="2"  
                  style="FONT-SIZE: 12px" name='endaccounttitle_no'>
		      <option value="" selected></option>
		      
		    
  
  
                     [#accounttitlelist#]    

                  


	      
	        </select></td>
	    </tr>
		<tr>
		  <td height="19" colspan="3" align="right"  class="form_label">对象类别：</td>
		  <td><select class=flat_input id=objecttype_id  
                  style="FONT-SIZE: 12px" name=objecttype_id[]>
		    <option value="" 
                    selected>-- 请选择对象类型 --</option>
		    
                   [#objecttypelist#]   
                  
	      </select></td>
	    </tr>
		<tr>
		  <td height="28" colspan="3" align="right"  class="form_label">起始对象：</td>
		  <td> <INPUT type="hidden" name="bgobject_id" ID="bgobject_id" value="0">
		    <input class=input type="text" name="bgobject_no"  id="bgobject_no" size="16" maxlength="20" value="" onClick="selectobject('bg');" >
		    <a  style="CURSOR: hand" onClick="copyobject('bgobject_no','endobject_no');">—&gt;</a>
          <INPUT type="hidden" name="endobject_id" ID="endobject_id" value="0">
          <input class=input type="text" name="endobject_no"  id="endobject_no" size="17" maxlength="20" value="" onClick="selectobject('end');" ></td>
	    </tr>
		<tr>
		  <td height="28" colspan="3" align="right"  class="form_label">起始日期：</td>
		   <td width="566"><input class=input type="text" name="bgdate" id="bgdate" size="16"  value="[#bgdate#]"  onFocus="calendar(EventUtil.getEvent().target)">
		   <a  style="CURSOR: hand" onClick="copyobject('bgdate','enddate');">—&gt;</a>
	           <input class=inputright type="text" name="enddate" id="enddate" size="17"  value="[#enddate#]" onFocus="calendar(EventUtil.getEvent().target)"></td>
	    </tr>
		<tr>
		  <td  height="13" colspan="4" >&nbsp;</td>
	    <tr>
          <td  height="20" colspan="4" class=bottombotton><div align="center" >
            <input type=button name=save class=buttonsmall value="统  计" style="font-size:9pt" onClick="javascript:submit_save()">
          </div></td>
    </table>
  </form>
<div id="sending" STYLE="LEFT: 0px; WIDTH: 95%; POSITION: absolute; TOP: 50%; HEIGHT: 95%; display: none"> 
       <table width=400 height=80 border=0 cellspacing=2 cellpadding=0 >
          <tr> 
               <td bgcolor=#F1F4F9 align=center>正在统计，请稍候...</td>
          </tr>
       </table>
</div>
<div id="sendingbg" STYLE="LEFT: 0px; WIDTH: 100%; POSITION: absolute; TOP: 0px; HEIGHT: 100%; display: none"> 
</div>
<DIV id=fadeinbox 
style="FILTER: progid:DXImageTransform.Microsoft.RandomDissolve(duration=1) progid:DXImageTransform.Microsoft.Shadow(color=gray,direction=135); moz-opacity: 0">
<FIELDSET><LEGEND valign="top" align="center"><strong>提示</strong></LEGEND>
<table width="100%" cellspacing="0" cellpadding="0" border="0">
<tr>
<td height="10">
</td>
</tr>
<tr>
<td>
&nbsp;&nbsp; 
</td>
</tr>
<tr>
<td height="10">
</td>
</tr>
</table>
</FIELDSET>
<table width="100%" cellspacing="0" cellpadding="0" border="0">
<tr>
<td width="100%" align="right"><span title=" 关 闭 窗 口 " 
      onclick="hidefadebox();return false" ><IMG height=16 hspace=2 
      src="../Images/CrossRed_path.gif" 
      width=16 align=absMiddle border=0>Close
    </span></td>
</tr>
</table>
</DIV>
</BODY>
</HTML>
